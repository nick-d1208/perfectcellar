var loginView=function(){"use strict";var o={},n=null,e="loginView",t=null,l={},i=null,a=!1;return o.backButtonClicked=new Event(e),o.loginButtonClicked=new Event(e),o.forgotPassButtonClicked=new Event(e),o.signUpButtonClicked=new Event(e),ClickControl&&(l.back=new ClickControl({selector:"#login",childSelector:".mp3-header .icon-left",callback:function(){o.backButtonClicked.notify()}}),l.login=new ClickControl({selector:"#login",childSelector:".sign-in",callback:function(){$("#login input").removeClass("invalid"),o.loginButtonClicked.notify({email:$("#login .input-email"),pass:$("#login .input-password")})}}),l.forgotpass=new ClickControl({selector:"#login",childSelector:".forgotten-password",callback:function(){o.forgotPassButtonClicked.notify()}}),l.signup=new ClickControl({selector:"#login",childSelector:".signup",callback:function(){o.signUpButtonClicked.notify()}}),l.input=new ClickControl({selector:"#login",childSelector:"input",callback:function(){$(this).focus(),$(this).removeClass("invalid")}})),o.start=function(){n=new PageTransitions({el:"#login",transition:"left"}),t=new IScroll("#login .wrapper-scroller",{hScrollbar:!1,vScrollbar:!1,hideScrollbar:!0,hideScrollbars:!0}),i=_.template($(".ajax-loader-template").html())},o.show=function(o,e){a=!0,$("#login, .trans-overlay").addClass("active"),e=!$.isEmptyObject(e)&&e&&"undefined"!=typeof e.dir?e.dir:"left",n.in(e,null,function(){$(".trans-overlay").removeClass("active"),"function"==typeof o&&o()})},o.hide=function(o,e){a=!1,e=!$.isEmptyObject(e)&&e&&"undefined"!=typeof e.dir?e.dir:"left",n.out(e,null,function(){$("#login").removeClass("active"),"function"==typeof o&&o()})},o.clearDetails=function(){$("#login input").val("")},o.showLoader=function(){$(".disable-overlay").addClass("show"),o.hideLoader(!0),$("#login").append(i())},o.hideLoader=function(o){o||$(".disable-overlay").removeClass("show"),$("#login .ajax-loader").remove()},o}(),loginController=function(){"use strict";function o(o){if(t=!0,""===o.email.val()&&(o.email.addClass("invalid"),t=!1),""===o.pass.val()&&(o.pass.addClass("invalid"),t=!1),!t)return!1;i.showLoader();var e={email:o.email.val(),token:o.pass.val()};handlerController.login(e,function(o){return l.createUser(o.d),globalEvent.notify("user:loggedin"),globalEvent.notify("app:updateUser"),n.hide(!1,{dir:"left"}),globalEvent.notify("home:show",{dir:"right"}),i.hideLoader(),!0},function(o){return i.hideLoader(),"n/a"===o?(Popup.createConfirmPopup("Login unsuccessful","Invalid username/password",null,"Okay"),!1):(Popup.createConfirmPopup("Login unsuccessful","Please connect to the internet to login.",null,"Okay"),!1)})}var n={},e=!1,t=!0,l=userModel,i=loginView;return globalEvent.attach("app:ready",function(){n.start()}),globalEvent.attach("login:show",function(o){n.show(!1,o)}),i.backButtonClicked.attach(function(){n.hide(!1,{dir:"left"}),globalEvent.notify("home:show",{dir:"right"})}),i.loginButtonClicked.attach(function(n,e){o(e)}),i.forgotPassButtonClicked.attach(function(){n.hide(!1,{dir:"right"}),globalEvent.notify("forgottenpassword:show",{dir:"left"})}),i.signUpButtonClicked.attach(function(){}),n.start=function(){i.start()},n.hide=function(o,n){e=!1,i.hide(function(){i.clearDetails(),"function"==typeof o&&o()},n)},n.show=function(o,n){e=!0,i.show(function(){"function"==typeof o&&o()},n)},n}(),logOutController=function(){function o(o){return"undefined"!=typeof o&&o.logoutNoPopup?(n(),!0):void Popup.createPopUp("Are you sure?","Once you logout, You will not be able to see all content.",function(){n()},function(){})}function n(){return l.getToken()&&l.getUser()?(e.showLoader(),void handlerController.logout({hash:l.getToken()},function(o){return l.removeUser(),globalEvent.notify("user:loggedout"),e.hideLoader(),!0},function(o){return l.removeUser(),globalEvent.notify("user:loggedout"),e.hideLoader(),!1})):(l.removeUser(),!0)}var e={},t=null,l=userModel;return globalEvent.attach("app:ready",function(){e.start()}),globalEvent.attach("user:logout",function(n){o(n)}),e.showLoader=function(){$(".disable-overlay").addClass("show"),e.hideLoader(!0),$("body").append(t())},e.hideLoader=function(o){o||$(".disable-overlay").removeClass("show"),$("body > .ajax-loader").remove()},e.start=function(){t=_.template($(".ajax-loader-template").html())},e}();